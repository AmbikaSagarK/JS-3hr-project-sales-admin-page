<html>
  <head>
   
  </meta>
  <style>
    .container {
  padding: 16px;
}
    form {
      background-color:white;
      font-size: 20px;
      color: black;
      text-align: center;
      
    }
    input{
      font-size: 30px;
      color: yellow;
      width: 1000px;
    }
  </style>

  </head>
  <body>
    <form onsubmit="saveToLocalStorage(event)">  
        <label> Selling price </label>
        <br>
        <input id="amount" type="number" name="amount" required>
        <br>    
        <label> Product name </label>
        <br>
        <input id="name" type="text" name="name" required>  
        <br> 
        <label>catagory </label>      
        <br>
        <input id="catagory" type="text" name="catagory" required>  
        <br>      
       <button onclick=""> Submit </button>
      <li>
        <button type="Delete">Delete</button>
      </li>
    </form>
    <ul id="listOfProducts"></ul>
    //<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
    <script>
      function saveToLocalStoarage(event){
        event.preventDefault();
      const price = event.target.amount.value;
      const name = event.target.productname.value;
      const catagory = event.target.catagory.value;
    //   localStorage.setItem('name',name);
    //   localStorage.setItem('email',email);
    //    localStorage.setItem('phonenumber',phonenumber);

       const obj = {
        amount,
        name,
        catagory,
       }

       axios.post("https://crudcrud.com/api/7bd568e301f041d7a932adf4cba5a369/saleadminpage",obj)
       .then((response) =>   {
        showProductOnScreen(response.data)
        //console.log(response)
       })
       //if something goes wrong    
       .catch((error) =>{
        document.body.innerHTML = document.body.innerHTML + "<h4> Something Went wrong </h4>"
        consolr.log(err)
       })
    //    localStorage.setItem(obj.email.JSON.stringyfy(obj))
    //    showNewUserOnScreen(obj)
      }
      
      window.addEventListener("DOMContentLoaded", () => {
        const date = axios.delete("https://crudcrud.com/api/65e1c4fa6be04cbebaf5f7395dd10b0c/saleadminpage/648416a3456f2b03e80bc86d")
        .then((response) => {
           // console.log(response);

            for(var i=0; i<response.data.length; i++) {
                showProductOnScreen(response.data[i])
            }
         })
         .catch=((error) => {
            console.log(error)
        })        
        console.log(data);
        // const localStorageObj = localStorage;
        // const localStoragekeys = Objects.keys(localStorageObj)

        // for(var i=0; i<localStoragkeys.length; i++){
        //     const key=localStoragekeys[i]
        //     const userDetailsString = localStorageObj[key];
        //     const userDetailsObj = JSON.parse(userDetailsString);
        //     showNewUserOnScreen(userDetailsObj)
        // }
      })
      function showProductOnScreen(user){
        document.getElementById('amount').value='';
        document.getElementById('name').value='';
        document.getElementById('catagory').value='';
        //console.log(localStorage.getItem(user.emailId))
        if(localStorage.getItem(user.email) !==null) {
          removeUserFromScree(user.email)
        }
        const parentNode = document.getElementById('ListOfProducts');
        const ChildHTML = <li id='$(user._id)'> '$(user.name)','$(user.email)'
                          <button onload ="deleteUser('$(user._id)')>Delete</button>" 
                            </li>

      ParentNode.innerHTML = parentNode.innerHTML + childHTML;
      }

      //Edit user
      function editUserDetails(amount, name, phonenumbercatagory, userId) {
      document.getElementById('amount').value=amount;
      document.getElementById('name').value=name;
      document.getElementById('catagory').value=catagory;

      deleteUser(userId)    
      }

      //deleteuser

      function deleteUser(userId){
      axios.delete('https://crudcrud.com/api/65e1c4fa6be04cbebaf5f7395dd10b0c/saleadminpage/$(userId)')
      .then((response)=>{
        removeProductFromScreen(userId)
      })
       .catch((err) => {
        console.log(err);
       })
      }
      function removeProductFromScreen(userId){
        const parentNode = document.getElementbyId('listOfProducts');
        const childNodeToBeDeleted = document.getElementbyId(catagory);
        if(childNodetoBeDeleted){
          parentNode.removeChild(childNodetoBeDeleted)
        }
      }
     
    
    </script>
  </body>
  
</html>